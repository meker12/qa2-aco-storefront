/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as s,jsxs as p,Fragment as H}from"@dropins/tools/preact-jsx-runtime.js";import{useState as _,useCallback as L,useEffect as k,useMemo as y,Fragment as S}from"@dropins/tools/preact-compat.js";import{classes as w,VComponent as F}from"@dropins/tools/lib.js";import{IllustratedMessage as $,Button as j,Icon as M}from"@dropins/tools/components.js";import{W as z}from"../chunks/WishlistItem.js";import{events as N}from"@dropins/tools/event-bus.js";import{s as B}from"../chunks/removeProductsFromWishlist.js";import{useText as x,Text as b}from"@dropins/tools/i18n.js";import{W as V}from"../chunks/WishlistAlert.js";import{S as q}from"../chunks/Heart.js";import"../chunks/Trash.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/HeartFilled.js";const A=({className:c,children:t,ctaLinkURL:n,...a})=>{const r=x({emptyWishlist:"Wishlist.EmptyWishlist.heading",message:"Wishlist.EmptyWishlist.message",cta:"Wishlist.EmptyWishlist.cta"});return s("div",{...a,className:w(["wishlist-empty-wishlist",c]),children:s($,{className:w(["wishlist-empty-wishlist__wrapper",c]),"data-testid":"wishlist-empty-wishlist",heading:r.emptyWishlist,icon:s(M,{className:"wishlist-empty-wishlist__icon",source:q}),message:s("p",{children:r.message}),action:n?s(j,{"data-testid":"wishlist-empty-wishlist-button",size:"medium",variant:"primary",type:"submit",href:n,children:r.cta},"routeHome"):void 0})})},ss=({routeEmptyWishlistCTA:c,routeToWishlist:t,moveProdToCart:n,...a})=>{const[r,d]=_(null),[W,h]=_(B.authenticated),u=l=>h(l),[g,m]=_(null),f=L(l=>{const{action:i,item:e}=l;m(s(V,{action:i,item:e}))},[t]);return k(()=>{const l=N.on("authenticated",u),i=N.on("wishlist/alert",o=>f(o)),e=N.on("wishlist/data",o=>{d(o)});return()=>{l==null||l.off(),e==null||e.off(),i==null||i.off()}},[f]),s(G,{...a,wishlistData:r,wishlistAlert:g,routeEmptyWishlistCTA:c,moveProdToCart:n,isLoggedIn:W})},G=({className:c,wishlistData:t,wishlistAlert:n,isLoggedIn:a,moveProdToCart:r,routeEmptyWishlistCTA:d,...W})=>{const[h,u]=_(n),g=x({wishlistHeading:"Wishlist.Wishlist.heading"}),m=y(()=>{var i;return((i=t==null?void 0:t.items)==null?void 0:i.length)>0?t.items.map(e=>{var o;return s(z,{initialData:e,moveProdToCart:r},(o=e.product)==null?void 0:o.sku)}):null},[t,r]);k(()=>{if(n){u(n);const i=setTimeout(()=>{u(null)},5e3);return()=>clearTimeout(i)}},[n]);const f=y(()=>h?s(F,{node:h,className:"wishlist-wishlist__alert"}):null,[h]),l=y(()=>{var e;if(!m)return null;const i=a?t==null?void 0:t.items_count:t.items.length;return s("div",{className:"wishlist-wishlist__heading","data-testid":"wishlist-heading-wrapper",children:s("div",{className:"wishlist-wishlist__heading-text","data-testid":"default-wishlist-heading",children:(e=g.wishlistHeading)==null?void 0:e.split(" {count}").map((o,v)=>{var I;return p(S,{children:[o,v===0&&s("span",{className:"wishlist-wishlist__heading-count","data-testid":"wishlist-heading-count",children:`${i} products`})]},((I=t==null?void 0:t.id)==null?void 0:I.toString())+v)})})})},[g,m,t]);return p("div",{...W,className:w(["wishlist-wishlist",c]),children:[f,m?p(H,{children:[l,s("div",{className:"wishlist-wishlist__content",children:m})]}):s("div",{className:w(["wishlist-wishlist__content","wishlist-wishlist__content--empty"]),children:p("div",{children:[s(A,{"data-testid":"empty-wishlist",ctaLinkURL:d==null?void 0:d()}),!a&&s(J,{})]})})]})},J=()=>p("div",{className:"wishlist-login__sign-in",children:[s("a",{"data-testid":"log-in-link",className:"wishlist-login__link",href:"/#",target:"_blank",rel:"noreferrer",children:s(b,{id:"Wishlist.Login.logIn"})}),s(b,{id:"Wishlist.Login.sync"})]});export{ss as Wishlist,ss as default};
